---
title: Kafkaæ¶ˆæ¯é‡‡ç”¨pullè¿˜æ˜¯push
icon: laptop-code
category:
  - ã€Šé¢è¯•1v1ã€‹
---







**æˆ‘æ˜¯ javapubï¼Œä¸€å `Markdown` ç¨‹åºå‘˜ä»ğŸ‘¨â€ğŸ’»ï¼Œå…«è‚¡æ–‡ç§å­é€‰æ‰‹ã€‚**



**<font color=blue>é¢è¯•å®˜</font>ï¼š å—¨ï¼Œå€™é€‰äººï¼ä½ çŸ¥é“Kafkaæ¶ˆæ¯ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„å—ï¼Ÿ**


**<font color=red>å€™é€‰äººï¼š</font>** å—¨ï¼Œé¢è¯•å®˜ï¼å½“ç„¶çŸ¥é“ï¼Kafkaæ˜¯ä¸€ä¸ªé«˜ååé‡çš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œå®ƒé‡‡ç”¨äº†Pushå’ŒPullçš„ç»“åˆæ–¹å¼æ¥å®ç°æ¶ˆæ¯ä¼ é€’ã€‚


**<font color=blue>é¢è¯•å®˜</font>ï¼š å“¦ï¼Œé‚£ä½ èƒ½å…·ä½“è§£é‡Šä¸€ä¸‹Kafkaçš„Pushå’ŒPullæ¨¡å¼å—ï¼Ÿ**


**<font color=red>å€™é€‰äººï¼š</font>** å½“ç„¶å¯ä»¥ï¼åœ¨Kafkaä¸­ï¼Œç”Ÿäº§è€…ï¼ˆProducerï¼‰è´Ÿè´£å°†æ¶ˆæ¯æ¨é€ï¼ˆPushï¼‰åˆ°Kafkaçš„BrokerèŠ‚ç‚¹ï¼Œè€Œæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰åˆ™ä»BrokerèŠ‚ç‚¹æ‹‰å–ï¼ˆPullï¼‰æ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚


**<font color=blue>é¢è¯•å®˜</font>ï¼š å¾ˆå¥½ï¼é‚£ä½ èƒ½ç»™æˆ‘ä»¬çœ‹ä¸€æ®µç®€å•çš„ä»£ç æ¥è¯´æ˜è¿™ä¸ªè¿‡ç¨‹å—ï¼Ÿ**


**<font color=red>å€™é€‰äººï¼š</font>** å½“ç„¶å¯ä»¥ï¼è®©æˆ‘ç»™ä½ å±•ç¤ºä¸€æ®µJavaä»£ç æ¥è¯´æ˜Kafkaçš„Pushå’ŒPullæ¨¡å¼ï¼š

```java
import org.apache.kafka.clients.producer.*;
import org.apache.kafka.clients.consumer.*;
import org.apache.kafka.common.serialization.StringDeserializer;
import org.apache.kafka.common.serialization.StringSerializer;

import java.util.Properties;

public class KafkaDemo {
    private static final String TOPIC = "my_topic";
    private static final String BOOTSTRAP_SERVERS = "localhost:9092";

    public static void main(String[] args) {
        // ç”Ÿäº§è€…ä»£ç 
        Properties producerProps = new Properties();
        producerProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, BOOTSTRAP_SERVERS);
        producerProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        producerProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());

        Producer<String, String> producer = new KafkaProducer<>(producerProps);
        producer.send(new ProducerRecord<>(TOPIC, "Hello Kafka!"));

        // æ¶ˆè´¹è€…ä»£ç 
        Properties consumerProps = new Properties();
        consumerProps.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, BOOTSTRAP_SERVERS);
        consumerProps.put(ConsumerConfig.GROUP_ID_CONFIG, "my_consumer_group");
        consumerProps.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        consumerProps.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());

        Consumer<String, String> consumer = new KafkaConsumer<>(consumerProps);
        consumer.subscribe(Collections.singleton(TOPIC));
        ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(1000));
        for (ConsumerRecord<String, String> record : records) {
            System.out.println("Received message: " + record.value());
        }
    }
}
```


**<font color=blue>é¢è¯•å®˜</font>ï¼š å¤ªæ£’äº†ï¼è¿™æ®µä»£ç å¾ˆå¥½åœ°å±•ç¤ºäº†Kafkaçš„Pushå’ŒPullæ¨¡å¼ã€‚é‚£ä¹ˆï¼Œä½ èƒ½è§£é‡Šä¸€ä¸‹ä»£ç ä¸­çš„å…³é”®éƒ¨åˆ†å—ï¼Ÿ**


**<font color=red>å€™é€‰äººï¼š</font>** å½“ç„¶å¯ä»¥ï¼åœ¨ç”Ÿäº§è€…éƒ¨åˆ†ï¼Œæˆ‘ä»¬é…ç½®äº†Kafkaçš„åœ°å€å’Œåºåˆ—åŒ–å™¨ï¼Œå¹¶ä½¿ç”¨`producer.send()`æ–¹æ³•å°†æ¶ˆæ¯æ¨é€åˆ°åä¸º`my_topic`çš„ä¸»é¢˜ä¸­ã€‚è€Œåœ¨æ¶ˆè´¹è€…éƒ¨åˆ†ï¼Œæˆ‘ä»¬é…ç½®äº†Kafkaçš„åœ°å€ã€æ¶ˆè´¹è€…ç»„IDå’Œååºåˆ—åŒ–å™¨ï¼Œå¹¶ä½¿ç”¨`consumer.poll()`æ–¹æ³•ä»ä¸»é¢˜ä¸­æ‹‰å–æ¶ˆæ¯ï¼Œç„¶åè¿›è¡Œå¤„ç†ã€‚


**<font color=blue>é¢è¯•å®˜</font>ï¼š éå¸¸æ¸…æ™°æ˜äº†ï¼ä½ å¯¹Kafkaçš„Pushå’ŒPullæ¨¡å¼æœ‰å¾ˆå¥½çš„ç†è§£ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆéœ€è¦æ³¨æ„çš„åœ°æ–¹å‘¢ï¼Ÿ**


**<font color=red>å€™é€‰äººï¼š</font>** å½“ç„¶æœ‰ï¼åœ¨ä½¿ç”¨Kafkaçš„Pushæ¨¡å¼æ—¶ï¼Œç”Ÿäº§è€…éœ€è¦ç¡®ä¿æ¶ˆæ¯èƒ½å¤ŸæˆåŠŸæ¨é€åˆ°BrokerèŠ‚ç‚¹ï¼Œè€Œåœ¨ä½¿ç”¨Pullæ¨¡å¼æ—¶ï¼Œæ¶ˆè´¹è€…éœ€è¦å®šæœŸæ‹‰å–æ¶ˆæ¯ä»¥ç¡®ä¿ä¸ä¼šé”™è¿‡ä»»ä½•é‡è¦çš„æ•°æ®ã€‚


**<font color=blue>é¢è¯•å®˜</font>ï¼š éå¸¸å¥½ï¼ä½ å¯¹Kafkaçš„Pushå’ŒPullæ¨¡å¼çš„ç†è§£éå¸¸åˆ°ä½ã€‚è°¢è°¢ä½ çš„å›ç­”ï¼**


**<font color=red>å€™é€‰äººï¼š</font>** éå¸¸æ„Ÿè°¢ï¼æˆ‘å¾ˆé«˜å…´èƒ½å¤Ÿåˆ†äº«æˆ‘çš„çŸ¥è¯†ã€‚å¦‚æœè¿˜æœ‰å…¶ä»–å…³äºKafkaæˆ–è€…ä»»ä½•å…¶ä»–æŠ€æœ¯çš„é—®é¢˜ï¼Œæˆ‘éƒ½ä¼šå°½åŠ›å¸®åŠ©è§£ç­”ï¼



![](https://ghproxy.com/https://raw.githubusercontent.com/Rodert/javapub_oss/main/other/40.jpg?raw=true)


æœ€è¿‘æˆ‘åœ¨æ›´æ–°ã€Šé¢è¯•1v1ã€‹ç³»åˆ—æ–‡ç« ï¼Œä¸»è¦ä»¥åœºæ™¯åŒ–çš„æ–¹å¼ï¼Œè®²è§£æˆ‘ä»¬åœ¨é¢è¯•ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œè‡´åŠ›äºè®©æ¯ä¸€ä½å·¥ç¨‹å¸ˆæ‹¿åˆ°è‡ªå·±å¿ƒä»ªçš„offerï¼Œæ„Ÿå…´è¶£å¯ä»¥å…³æ³¨**å…¬ä¼—å·JavaPub**è¿½æ›´ï¼


![](https://ghproxy.com/https://raw.githubusercontent.com/Rodert/javapub_oss/main/common/javapub-qr-code.png?raw=true)


ğŸç›®å½•åˆé›†ï¼š

Giteeï¼š`https://gitee.com/rodert/JavaPub`

GitHubï¼š`https://github.com/Rodert/JavaPub`


<http://javapub.net.cn>

