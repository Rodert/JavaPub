import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as o,a as s,b as t,w as n,d as i,e as a,r,o as p}from"./app-D3ONNahh.js";const h={},d=s("p",null,[s("strong",null,[i("我是 javapub，一名 "),s("code",null,"Markdown"),i(" 程序员从👨‍💻，八股文种子选手。")])],-1),k=a(`<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> acquire_lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">redis_conn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">lock_key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">lock_value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">lock_timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> redis_conn.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">setnx</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(lock_key, lock_value):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        redis_conn.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">expire</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(lock_key, lock_timeout)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> False</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> release_lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">redis_conn</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">lock_key</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#24292E;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">lock_value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> redis_conn.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(lock_key) </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> lock_value:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        redis_conn.</span><span style="--shiki-light:#24292E;--shiki-dark:#61AFEF;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(lock_key)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> True</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> False</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),c=s("code",null,"acquire_lock",-1),u=s("code",null,"setnx",-1),g=s("code",null,"release_lock",-1),y=a('<figure><img src="https://ghproxy.com/https://raw.githubusercontent.com/Rodert/javapub_oss/main/other/31.jpg?raw=true" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>最近我在更新《面试1v1》系列文章，主要以场景化的方式，讲解我们在面试中遇到的问题，致力于让每一位工程师拿到自己心仪的offer，感兴趣可以关注<strong>公众号JavaPub</strong>追更！</p><figure><img src="https://javapub-common-oss.oss-cn-beijing.aliyuncs.com/javapub/2024%2F06%2F06%2F20240606-225632.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>🎁目录合集：</p><p>Gitee：<code>https://gitee.com/rodert/JavaPub</code></p><p>GitHub：<code>https://github.com/Rodert/JavaPub</code></p><p><a href="http://javapub.net.cn" target="_blank" rel="noopener noreferrer">http://javapub.net.cn</a></p>',7);function m(_,f){const e=r("font");return p(),o("div",null,[d,s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 嗨，候选人！听说你对Redis分布式锁很感兴趣，是吗？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 是的，面试官！我对分布式锁的实现方式很感兴趣，尤其是Redis作为分布式锁的选择。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 很好！那我们就来聊聊Redis分布式锁的原理吧。你知道Redis是如何实现分布式锁的吗？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 当然！Redis使用的是基于SETNX命令的方式来实现分布式锁。我可以给你演示一下源码实现吗？")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 当然可以！请开始你的表演。")])]),k,s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 这是一个简单的Python代码示例。在"),c,i("函数中，我们使用"),u,i("命令来尝试获取锁。如果成功获取到锁，我们设置锁的过期时间，并返回True。如果获取锁失败，我们返回False。在"),g,i("函数中，我们首先检查锁的值是否与传入的值相等，如果相等，我们删除锁并返回True，否则返回False。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 看起来很简单明了！但是，有没有什么需要注意的地方呢？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 当然有！在使用Redis分布式锁时，我们需要注意两个主要问题。首先是锁的超时时间，我们需要确保在业务逻辑执行期间锁不会过期。其次是锁的释放，我们需要确保只有持有锁的客户端才能释放锁，避免误释放。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 非常重要的提醒！那么，你有什么建议来优化Redis分布式锁的性能吗？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 当然！一个常见的优化方式是使用Lua脚本来减少网络开销。通过将获取锁和设置过期时间的操作合并为一个原子操作，可以减少网络往返次数，提高性能。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 很棒的建议！还有其他的优化策略吗？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 另一个优化策略是使用Redlock算法来增加锁的可靠性。Redlock算法通过在多个Redis实例上获取锁，以提高分布式锁的可用性和容错性。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 非常有见地！你对Redis分布式锁的了解令人印象深刻。有没有什么其他问题或者想法？")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 我认为在使用Redis分布式锁时，我们还应该考虑到网络延迟和故障的情况，以及如何处理死锁和锁竞争的情况。")]),s("p",null,[s("strong",null,[t(e,{color:"blue"},{default:n(()=>[i("面试官")]),_:1}),i("： 非常好的观点！你对分布式锁的理解非常全面。我对你的回答印象深刻！谢谢你的时间。")])]),s("p",null,[s("strong",null,[t(e,{color:"red"},{default:n(()=>[i("候选人：")]),_:1})]),i(" 非常感谢您的赞赏，面试官！我很高兴能与您分享我的见解。")]),y])}const B=l(h,[["render",m],["__file","31.Redis_fenbushisuo.html.vue"]]),A=JSON.parse('{"path":"/posts/special/1v1/31.Redis_fenbushisuo.html","title":"Redis分布式锁","lang":"zh-CN","frontmatter":{"title":"Redis分布式锁","icon":"laptop-code","category":["《面试1v1》"],"description":"我是 javapub，一名 Markdown 程序员从👨‍💻，八股文种子选手。 ： 嗨，候选人！听说你对Redis分布式锁很感兴趣，是吗？ 是的，面试官！我对分布式锁的实现方式很感兴趣，尤其是Redis作为分布式锁的选择。 ： 很好！那我们就来聊聊Redis分布式锁的原理吧。你知道Redis是如何实现分布式锁的吗？ 当然！Redis使用的是基于SE...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/posts/special/1v1/31.Redis_fenbushisuo.html"}],["meta",{"property":"og:site_name","content":"JavaPub"}],["meta",{"property":"og:title","content":"Redis分布式锁"}],["meta",{"property":"og:description","content":"我是 javapub，一名 Markdown 程序员从👨‍💻，八股文种子选手。 ： 嗨，候选人！听说你对Redis分布式锁很感兴趣，是吗？ 是的，面试官！我对分布式锁的实现方式很感兴趣，尤其是Redis作为分布式锁的选择。 ： 很好！那我们就来聊聊Redis分布式锁的原理吧。你知道Redis是如何实现分布式锁的吗？ 当然！Redis使用的是基于SE..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://ghproxy.com/https://raw.githubusercontent.com/Rodert/javapub_oss/main/other/31.jpg?raw=true"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-03T14:35:52.000Z"}],["meta",{"property":"article:author","content":"Mr.Wang"}],["meta",{"property":"article:modified_time","content":"2024-07-03T14:35:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Redis分布式锁\\",\\"image\\":[\\"https://ghproxy.com/https://raw.githubusercontent.com/Rodert/javapub_oss/main/other/31.jpg?raw=true\\",\\"https://javapub-common-oss.oss-cn-beijing.aliyuncs.com/javapub/2024%2F06%2F06%2F20240606-225632.png\\"],\\"dateModified\\":\\"2024-07-03T14:35:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Wang\\",\\"url\\":\\"https://javapub.net.cn\\"}]}"]]},"headers":[],"git":{"createdTime":1717568495000,"updatedTime":1720017352000,"contributors":[{"name":"wangshiyu","email":"iswangshiyu@foxmail.com","commits":1}]},"readingTime":{"minutes":3.02,"words":907},"filePathRelative":"posts/special/1v1/31.Redis_fenbushisuo.md","localizedDate":"2024年6月5日","excerpt":"<p><strong>我是 javapub，一名 <code>Markdown</code> 程序员从👨‍💻，八股文种子选手。</strong></p>\\n<p><strong>： 嗨，候选人！听说你对Redis分布式锁很感兴趣，是吗？</strong></p>\\n<p><strong></strong> 是的，面试官！我对分布式锁的实现方式很感兴趣，尤其是Redis作为分布式锁的选择。</p>\\n<p><strong>： 很好！那我们就来聊聊Redis分布式锁的原理吧。你知道Redis是如何实现分布式锁的吗？</strong></p>\\n<p><strong></strong> 当然！Redis使用的是基于SETNX命令的方式来实现分布式锁。我可以给你演示一下源码实现吗？</p>","autoDesc":true}');export{B as comp,A as data};
